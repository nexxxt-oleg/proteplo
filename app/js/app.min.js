document.addEventListener("DOMContentLoaded", () => {


    if (document.getElementById('homeSlider1')) {
        new Swiper('#homeSlider1', {
            spaceBetween: 30,
            loop: true,
            pagination: {
                el: '#homeSlider1 .home-sliders__pagination',
                clickable: true,
            },
        });
    }
    if (document.getElementById('homeSlider2')) {
        new Swiper('#homeSlider2', {
            spaceBetween: 30,
            loop: true,
            pagination: {
                el: '#homeSlider2 .home-sliders__pagination',
                clickable: true,
            },
        });
    }
    if (document.getElementById('newsSlider')) {
        const sliderBrands = new Swiper('#newsSlider', {
            spaceBetween: 30,
            slidesPerView: 3,
            slidesPerGroup: 1,
            navigation: {
                nextEl: '#newsSliderNext',
                prevEl: '#newsSliderPrev',
            },

            breakpoints: {
                300: {
                    slidesPerView: 1,
                    spaceBetween: 15
                },
                600: {
                    slidesPerView: 2,
                    spaceBetween: 20
                },
                991: {
                    slidesPerView: 3,
                    spaceBetween: 20
                },
                1200: {
                    slidesPerView: 3,
                    spaceBetween: 30
                },
            },

        });
    }

    let sliderProduct = document.querySelectorAll(".slider-product");

    sliderProduct.forEach(function (sliderItem) {
        let nextBtn = '#' + sliderItem.dataset.next;
        let prevBtn = '#' + sliderItem.dataset.prev;

        new Swiper(sliderItem, {
            spaceBetween: 30,
            slidesPerView: 4,
            slidesPerGroup: 1,
            navigation: {
                nextEl: nextBtn,
                prevEl: prevBtn,
            },

            breakpoints: {
                300: {
                    slidesPerView: 1,
                    spaceBetween: 15
                },
                600: {
                    slidesPerView: 2,
                    spaceBetween: 20
                },
                991: {
                    slidesPerView: 3,
                    spaceBetween: 20
                },
                1200: {
                    slidesPerView: 4,
                    spaceBetween: 30
                },
            },

        });
    });

    if (document.getElementById('sliderBrand')) {
        new Swiper("#sliderBrand", {
            slidesPerView: 6,
            grid: {
                rows: 2,
            },
            spaceBetween: 30,
            lazy: true,
            navigation: {
                nextEl: '#sliderBrandNext',
                prevEl: '#sliderBrandPrev',
            },
        });
    }
    if (document.getElementById('sliderNews')) {
        new Swiper("#sliderNews", {
            slidesPerView: 3,
            spaceBetween: 30,
            lazy: true,
            navigation: {
                nextEl: '#sliderNewsNext',
                prevEl: '#sliderNewsPrev',
            },
        });
    }


    const widthScreen = window.innerWidth || document.documentElement.clientWidth ||
        document.body.clientWidth;

    if (document.getElementById('seoText')) {
        new Readmore('#seoText', {
            collapsedHeight: 225,
            moreLink: '<div class="seo-text__footer"><a href="" class="btn-link">' +
                'Подробнее <svg width="12" height="6" class="ml-5">\n' +
                '                    <use xlink:href="#svg-bottom"></use>\n' +
                '                </svg></a></div>',
            lessLink: '<div class="seo-text__footer"><a href="" class="btn-link">' +
                'Скрыть <svg width="12" height="6" class="ml-5">\n' +
                '                    <use xlink:href="#svg-up"></use>\n' +
                '                </svg></a></div>',
        });
    }

    function getScrollMenu() {
        let el = document.body;
        if (pageYOffset > 300) {
            el.classList.add('fix_menu');
        } else {
            el.classList.remove("fix_menu");
        }
    }

    getScrollMenu();
    window.addEventListener('scroll', function () {
        getScrollMenu();
    });

    if (document.getElementById('searchBox')) {
        let searchBox = document.getElementById('searchBox');
        let searchHeader = document.getElementById('searchHeader');
        let searchBoxRemove = document.getElementById('searchBoxRemove');

        searchBox.addEventListener("mouseover", () => {
            document.body.classList.add('search_active');
            if (searchHeader.value.length > 0) {
                activeSearch();
            }
        });
        searchBox.addEventListener("mouseout", () => {
            if (document.body.classList.contains('search_active')) {
                document.body.classList.remove('search_active');
            }
            let searchBoxResult = document.getElementById('searchBoxResult');
            if (searchBoxResult.classList.contains('active')) {
                searchBoxResult.classList.remove('active');
            }
        });

        searchHeader.addEventListener("input", () => {
            if (searchHeader.value.length > 0) {
                activeSearch();
            } else {
                clearSearch(event);
            }
        });

        searchBoxRemove.addEventListener("click", clearSearch);
    }
    let elemetsMenu = document.querySelectorAll('.catalog-menu__nav li')

    elemetsMenu.forEach((el) => {
        el.addEventListener('mouseover', () => {
            let activeNav = document.querySelector('.catalog-menu__nav li.active');
            if (activeNav) {
                activeNav.classList.remove("active");
            }

            el.classList.add('active');
            let activeIdSubNav = el.dataset.target;

            let removeActiveNav = document.querySelector('.catalog-menu__list__item.active');
            if (removeActiveNav) {
                removeActiveNav.classList.remove("active");
            }

            if (document.getElementById(activeIdSubNav)) {
                document.getElementById(activeIdSubNav).classList.add("active");
            }
        });

    });

    if(document.getElementById('collapseMenu')) {
        const collapseMenu = document.getElementById('collapseMenu');

        const scrollMenu = new SimpleBar(document.getElementById('scrollMenu'), { autoHide: false });
        collapseMenu.addEventListener('hidden.bs.collapse', event => {
            document.body.classList.remove('menu_open');
            document.getElementById('fixNavWrap').style.paddingRight = '0px';
            document.body.style.paddingRight = '0px';
        });
        collapseMenu.addEventListener('show.bs.collapse', event => {
            document.body.classList.add('menu_open');
            document.getElementById('fixNavWrap').style.paddingRight = getScrollBarWidth()+'px';
            document.body.style.paddingRight = getScrollBarWidth()+'px';
        });
    }

    const maskPhone = document.querySelectorAll('.js-mask-phone');
    maskPhone.forEach(el => {
        let im = new Inputmask("+7 999 999-99-99", {"clearIncomplete": true});
        im.mask(el);
    })

});


function clearSearch(event) {
    let searchBoxRemove = document.getElementById('searchBoxRemove');
    document.getElementById('searchHeader').value = '';
    if (searchBoxRemove.classList.contains('active')) {
        searchBoxRemove.classList.remove('active');
    }
    event.preventDefault();
}

function activeSearch() {
    let searchBoxResult = document.getElementById('searchBoxResult');
    let searchBoxRemove = document.getElementById('searchBoxRemove');
    searchBoxResult.classList.add('active');
    searchBoxRemove.classList.add('active');
}

function getScrollBarWidth() {
    var inner = document.createElement('p');
    inner.style.width = "100%";
    inner.style.height = "200px";
    var outer = document.createElement('div');
    outer.style.position = "absolute";
    outer.style.top = "0px";
    outer.style.left = "0px";
    outer.style.visibility = "hidden";
    outer.style.width = "200px";
    outer.style.height = "150px";
    outer.style.overflow = "hidden";
    outer.appendChild (inner);
    document.body.appendChild (outer);
    var w1 = inner.offsetWidth;
    outer.style.overflow = 'scroll';
    var w2 = inner.offsetWidth;
    if (w1 == w2) w2 = outer.clientWidth;
    document.body.removeChild (outer);
    return (w1 - w2);
};
